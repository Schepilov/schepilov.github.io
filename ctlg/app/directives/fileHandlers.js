app.directive("fileRead",function(){var a=function(a){return a.substr(a.indexOf("base64,")+7)};return{scope:{fileRead:"="},link:function(b,c,d){c.bind("change",function(c){d.multiple&&(b.fileRead=[]),_.each(c.target.files,function(c){var e=new FileReader;e.onload=function(e){var f=this.result,g={name:c.name,mimeType:c.type,content:a(f)};b.$apply(function(){d.multiple?b.fileRead.push(g):b.fileRead=g})},e.readAsDataURL(c)})})}}}),app.directive("imageUploader",["$rootScope","$timeout","uploadService",function(a,b,c){var d=function(a){return a.substr(a.indexOf("base64,")+7)};return{restrict:"EA",scope:{previewId:"@"},template:'<input type="file" class="form-control">',link:function(b,e,f){e.bind("change",function(e){var g="";switch(f.uploadType){case"companyProfile":g="flow/customer-brands/0/upload-profile-image";break;case"userProfile":g="flow/auth/upload-profile-image";break;case"brandMaterial":g="flow/customer-brand-material-items/"+$(this).data("itemId")+"/storeFile";break;case"requestItem":g="flow/workflow-request-items/"+f.itemid+"/upload"}a.$broadcast("fileAdded",g);var h=e.target.files[0],i=new FileReader;a.$broadcast(f.uploadType+"Uploading",h),i.onload=function(){var e={name:h.name,mimeType:h.type,destination:g,content:d(this.result)};c.addFile(e).then(function(){if(a.$broadcast(f.uploadType+"Uploaded",e),b.previewId){document.getElementById(b.previewId).src=URL.createObjectURL(h)}})},i.readAsDataURL(h)})}}}]);