app.service("dataService",["$rootScope","$http","$q","$filter","paginationService",function(a,b,c,d,e){var f=[],g={},h={},i={},j=3e5,k=function(){return j},l=function(a){j=a},m=function(a,b,d){var e=c.defer();return o(b).then(function(c){p(c,a,d),_.isEmpty(g)?n(a,b).then(e.resolve):e.resolve(g)}),e.promise},n=function(d,e,f,g){var h=c.defer(),i={},j=a.settings.baseUrl+e+"/"+d;return _.isString(f)&&(j+="/"+f),_.isObject(g)&&(i.params=g),b.get(j,i).success(h.resolve).error(h.reject),h.promise},o=function(d,e){var g=c.defer(),k=d;if(_.isObject(e)&&(k+=angular.toJson(e)),i[k]&&_.now()>i[k]+j&&(h[k]=[]),_.isEmpty(h[k])){var l={};_.isObject(e)&&(l.params=e),b.get(a.settings.baseUrl+d,l).success(function(a){i[k]=_.now(),h[k]=f=a,g.resolve(h[k])}).error(function(a){g.reject(a)})}else g.resolve(h[k]);return g.promise},p=function(a,b,c){g=null;var d={};angular.isString(c)||(c="id"),d[c]=b;var e=_.findIndex(a,d);return e>=0&&(g=a[e]),g},q=function(d,e){var f=c.defer();return b.post(a.settings.baseUrl+d,e).success(function(a){h={},f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},r=function(d,e,f){var g=c.defer();return b.put(a.settings.baseUrl+e+"/"+d,f).success(function(a){h={},g.resolve(a)}).error(function(a){g.reject(a)}),g.promise},s=function(d,e){var f=c.defer();return b.delete(a.settings.baseUrl+e+"/"+d).success(function(a){h={},f.resolve(a)}).error(function(a){f.reject(a)}),f.promise},t=function(a,b,c,d){return h={},n(a,b,c,d)};return{init:function(a,b){return{getCacheTime:k,setCacheTime:l,get:function(b,c){return m(b,a,c)},load:function(b,c,d){return n(b,a,c,d)},create:function(b){return q(a,b)},update:function(b,c){return r(b,a,c)},delete:function(b){return s(b,a)},fetch:function(d,f,g){var h=c.defer();return o(a,b).then(function(a){h.resolve(e.get(d,a,f,g))}),h.promise},fetchAll:function(){return o(a,b)},reset:function(){h={}},doAction:function(b,c,d){return t(b,a,c,d)},getEntityById:p}},extractEntities:function(a,b,c){var d=[];return _.each(a,function(a){var e=_.findWhere(d,{id:a[b]});_.isObject(e)||d.push({id:a[b],name:a[c]})}),d}}}]);